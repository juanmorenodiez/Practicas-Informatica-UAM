package ads.practica3;

import java.text.DecimalFormat;
import java.text.DecimalFormatSymbols;
import java.util.*;

public class Venta {
    private Electrodomestico electrodomesticoVenta;
    private Electrodomestico electrodomesticoEntrega;
    private static ArrayList<Venta> ventas = new ArrayList<>();

    public Venta(Electrodomestico eV, Electrodomestico eE) {
        this.electrodomesticoVenta = eV;
        this.electrodomesticoEntrega = eE;
        ventas.add(this);   
    }

    public Venta(Electrodomestico eV) {
        this.electrodomesticoVenta = eV;
        ventas.add(this);
    }


    public Electrodomestico getElectrodomesticoVenta() {
        return electrodomesticoVenta;
    }

    public void setElectrodomesticoVenta(Electrodomestico electrodomesticoVenta) {
        this.electrodomesticoVenta = electrodomesticoVenta;
    }

    public Electrodomestico getElectrodomesticoEntrega() {
        return electrodomesticoEntrega;
    }

    public void setElectrodomesticoEntrega(Electrodomestico electrodomesticoEntrega) {
        this.electrodomesticoEntrega = electrodomesticoEntrega;
    }

    public double descuento() {
        int entrega;
        int venta;

        if (electrodomesticoEntrega == null) {
            return 0;
        }

        venta = this.getElectrodomesticoVenta().getClaseEnergetica().getValor();
        entrega = this.getElectrodomesticoEntrega().getClaseEnergetica().getValor();


        if (entrega == venta && entrega != 4) {
            return 25.0;
        }

        else if (entrega < venta && entrega != 4) {
            venta -= entrega;

            return 25 - (5 * venta);
        }

        else if (entrega > venta && entrega != 4) {
            entrega -= venta;

            return 25 + (15 * entrega);
        }

        else
            return 10;
    }

    public double precioTotal(){
        return electrodomesticoVenta.getPrecioBase() - this.descuento();
    }
    
    public static Venta ultima() {
    	return ventas.get(ventas.size() - 1);
    }
    
    public static String resumenVentas() {
    	String resumen = "\nRESUMEN DE VENTAS\n";
    	
    	for (int i = 0; i < ventas.size(); i++) {
    		resumen += ventas.get(i).getTotal();
    	}
    	
    	return resumen;
    }
    
    
    public static String resumenVentas(int importe) {
    	String resumen = "\nRESUMEN DE VENTAS\n";
    	
    	for (int i = 0; i < ventas.size(); i++) {
    		if (ventas.get(i).precioTotal() > importe) {
    			resumen += ventas.get(i).getTotal();
    		}
    	}
    	
    	return resumen;
    }
    
    
    
    public static String resumenVentas(String cadena) {
    	String resumen = "\nRESUMEN DE VENTAS\n";
    	
    	for (int i = 0; i < ventas.size(); i++) {
    		if (ventas.get(i).electrodomesticoVenta.getMarca().equals(cadena)) {
    			resumen += ventas.get(i).getTotal();
    		}
    	}
    	
    	return resumen;
    }
    
    
    
   public static Venta anular() {
	   Venta v;
	   
	   v = ventas.get(ventas.size() -1);
	   
	   ventas.remove(v);
	   
	   return v;
	   
   }
    
    public String getLinea1() {
    	DecimalFormatSymbols separadoresPersonalizados = new DecimalFormatSymbols();
    	separadoresPersonalizados.setDecimalSeparator('.');
    	DecimalFormat formato = new DecimalFormat("#.00", separadoresPersonalizados);
    	return "Producto vendido: " + electrodomesticoVenta.getMarca() + " " +
                electrodomesticoVenta.getModelo() + ", " + formato.format(electrodomesticoVenta.getPrecioBase()) + " Euros\n";
    }
    
    public String getLinea2() {
    	DecimalFormatSymbols separadoresPersonalizados = new DecimalFormatSymbols();
    	separadoresPersonalizados.setDecimalSeparator('.');
    	DecimalFormat formato = new DecimalFormat("#.00", separadoresPersonalizados);
    	return "Precio producto:    " + formato.format(electrodomesticoVenta.getPrecioBase()) + " Euros\n";
    }
    
    public String getLinea3() {
    	DecimalFormatSymbols separadoresPersonalizados = new DecimalFormatSymbols();
    	separadoresPersonalizados.setDecimalSeparator('.');
    	DecimalFormat formato = new DecimalFormat("#.00", separadoresPersonalizados);
    	return "Descuento entrega:  " + formato.format(this.descuento()) + " Euros\n";
    }
    
    public String getTotal() {
    	DecimalFormatSymbols separadoresPersonalizados = new DecimalFormatSymbols();
    	separadoresPersonalizados.setDecimalSeparator('.');
    	DecimalFormat formato = new DecimalFormat("#.00", separadoresPersonalizados);
    	return "TOTAL:              "               + formato.format(this.precioTotal()) + " Euros\n";
    }

    public String getTicket() {
        return "--------------------------------------------\n" +
        		this.getLinea1()
                + "-------------------------------------------- \n" +
                this.getLinea2() +
                this.getLinea3() +
                this.getTotal();
    }
}
